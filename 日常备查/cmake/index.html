
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://zhizhang77.github.io/tips/%E6%97%A5%E5%B8%B8%E5%A4%87%E6%9F%A5/cmake/">
      
      
        <link rel="prev" href="../MD%E5%9F%BA%E6%9C%AC%E6%A0%B7%E5%BC%8F/">
      
      
        <link rel="next" href="../ffmpeg-chs/">
      
      <link rel="icon" href="../../resources/github_icon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.14">
    
    
      
        <title>Cmake - zz的杂物堆</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cmake" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="zz的杂物堆" class="md-header__button md-logo" aria-label="zz的杂物堆" data-md-component="logo">
      
  <img src="../../resources/github_icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            zz的杂物堆
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cmake
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zhizhang77/tips/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    zhizhang77/tips
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="zz的杂物堆" class="md-nav__button md-logo" aria-label="zz的杂物堆" data-md-component="logo">
      
  <img src="../../resources/github_icon.png" alt="logo">

    </a>
    zz的杂物堆
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zhizhang77/tips/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    zhizhang77/tips
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome to zz的杂物堆
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          各种链接
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          各种链接
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/DL%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        DL 相关工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/Python%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="md-nav__link">
        Python性能优化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/UI%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        UI开发工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/awesomenontech/" class="md-nav__link">
        各种非技术类的资源网站收集
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/awesometutorials/" class="md-nav__link">
        技术类tutorial、课程和示例网站
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/profiling%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        profiling工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/%E4%B8%8B%E8%BD%BD%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        下载工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        图像处理工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96/" class="md-nav__link">
        数据分析与可视化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/%E6%96%87%E6%A1%A3%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        文档工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/%E6%9D%82%E9%A1%B9%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        杂项工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        浏览器工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/%E7%94%BB%E5%9B%BE%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        画图工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%84%E7%A7%8D%E9%93%BE%E6%8E%A5/%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        调试工具
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          日常备查
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          日常备查
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MD%E5%9F%BA%E6%9C%AC%E6%A0%B7%E5%BC%8F/" class="md-nav__link">
        MPE支持的Markdown样式
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Cmake
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Cmake
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cmake" class="md-nav__link">
    一、Cmake 简介
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    二、常用命令
  </a>
  
    <nav class="md-nav" aria-label="二、常用命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cmake" class="md-nav__link">
    1. 指定 cmake 的最小版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 设置项目名称
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 设置编译类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. 指定编译包含的源文件
  </a>
  
    <nav class="md-nav" aria-label="4. 指定编译包含的源文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1 明确指定包含哪些源文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-cpp" class="md-nav__link">
    4.2 搜索所有的 cpp 文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" class="md-nav__link">
    4.3 自定义搜索规则
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. 查找指定的库文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. 设置包含的目录
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7. 设置链接库搜索目录
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-target" class="md-nav__link">
    8. 设置 target 需要链接的库
  </a>
  
    <nav class="md-nav" aria-label="8. 设置 target 需要链接的库">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81" class="md-nav__link">
    8.1 指定链接动态库或静态库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82" class="md-nav__link">
    8.2 指定全路径
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83" class="md-nav__link">
    8.3 指定链接多个库
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    9. 设置变量
  </a>
  
    <nav class="md-nav" aria-label="9. 设置变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-set" class="md-nav__link">
    9.1 set 直接设置变量的值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-set" class="md-nav__link">
    9.2 set 追加设置变量的值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-list" class="md-nav__link">
    9.3 list 追加或者删除变量的值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94" class="md-nav__link">
    9.4 编译时设置宏定义
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10. 条件控制
  </a>
  
    <nav class="md-nav" aria-label="10. 条件控制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-ifelseifelseendif" class="md-nav__link">
    10.1 if…elseif…else…endif
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-whileendwhile" class="md-nav__link">
    10.2 while…endwhile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-foreachendforeach" class="md-nav__link">
    10.3 foreach…endforeach
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    11. 打印信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-cmake" class="md-nav__link">
    12. 包含其它 cmake 文件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    三、常用变量
  </a>
  
    <nav class="md-nav" aria-label="三、常用变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 预定义变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2. 环境变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    3. 系统信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    4. 主要开关选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    5. 常用编译选项配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-vscodecmake-tools" class="md-nav__link">
    6. 交叉编译配置示例（基于VSCode加CMake tools插件）
  </a>
  
    <nav class="md-nav" aria-label="6. 交叉编译配置示例（基于VSCode加CMake tools插件）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-toolchain" class="md-nav__link">
    6.1 toolchain文件：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-kit" class="md-nav__link">
    6.2 添加编译kit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-cmakeliststxt" class="md-nav__link">
    6.3 CMakeLists.txt示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ffmpeg-chs/" class="md-nav__link">
        FFmpeg CheatSheet中文（忘记出处，未检查，正确性不保证）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ffmpeg-eng/" class="md-nav__link">
        FFmpeg cheat sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../matplotlib%E5%85%A5%E9%97%A8/" class="md-nav__link">
        Matplotlib入门
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../numba/" class="md-nav__link">
        numba的使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
          Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E5%AE%B9%E5%99%A8%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        Docker安装与容器配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker/%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/" class="md-nav__link">
        基本命令
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
          Pandas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Pandas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pandas/pandas%20style/" class="md-nav__link">
        Pandas style
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          豆知识
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          豆知识
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/Python%E5%8E%9F%E7%94%9F%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/" class="md-nav__link">
        Python虚拟环境
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/arm%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E8%AF%A6%E8%A7%A3/" class="md-nav__link">
        Arm交叉编译详解
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/colab/" class="md-nav__link">
        colab小技巧记录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/dataset/" class="md-nav__link">
        数据集相关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/electron-nodejs/" class="md-nav__link">
        Electron nodejs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/git/" class="md-nav__link">
        git相关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/jupyter/" class="md-nav__link">
        jupyter相关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/opencv/" class="md-nav__link">
        opencv相关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/os/" class="md-nav__link">
        OS相关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/python/" class="md-nav__link">
        python相关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/qt/" class="md-nav__link">
        qt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/sympy/" class="md-nav__link">
        Sympy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/vscode/" class="md-nav__link">
        VSCode相关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B1%86%E7%9F%A5%E8%AF%86/wsl/" class="md-nav__link">
        WSL相关
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cmake" class="md-nav__link">
    一、Cmake 简介
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    二、常用命令
  </a>
  
    <nav class="md-nav" aria-label="二、常用命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cmake" class="md-nav__link">
    1. 指定 cmake 的最小版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 设置项目名称
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 设置编译类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. 指定编译包含的源文件
  </a>
  
    <nav class="md-nav" aria-label="4. 指定编译包含的源文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1 明确指定包含哪些源文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-cpp" class="md-nav__link">
    4.2 搜索所有的 cpp 文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" class="md-nav__link">
    4.3 自定义搜索规则
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. 查找指定的库文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. 设置包含的目录
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7. 设置链接库搜索目录
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-target" class="md-nav__link">
    8. 设置 target 需要链接的库
  </a>
  
    <nav class="md-nav" aria-label="8. 设置 target 需要链接的库">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81" class="md-nav__link">
    8.1 指定链接动态库或静态库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82" class="md-nav__link">
    8.2 指定全路径
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83" class="md-nav__link">
    8.3 指定链接多个库
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    9. 设置变量
  </a>
  
    <nav class="md-nav" aria-label="9. 设置变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-set" class="md-nav__link">
    9.1 set 直接设置变量的值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-set" class="md-nav__link">
    9.2 set 追加设置变量的值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-list" class="md-nav__link">
    9.3 list 追加或者删除变量的值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94" class="md-nav__link">
    9.4 编译时设置宏定义
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10. 条件控制
  </a>
  
    <nav class="md-nav" aria-label="10. 条件控制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-ifelseifelseendif" class="md-nav__link">
    10.1 if…elseif…else…endif
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-whileendwhile" class="md-nav__link">
    10.2 while…endwhile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-foreachendforeach" class="md-nav__link">
    10.3 foreach…endforeach
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    11. 打印信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-cmake" class="md-nav__link">
    12. 包含其它 cmake 文件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    三、常用变量
  </a>
  
    <nav class="md-nav" aria-label="三、常用变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 预定义变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2. 环境变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    3. 系统信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    4. 主要开关选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    5. 常用编译选项配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-vscodecmake-tools" class="md-nav__link">
    6. 交叉编译配置示例（基于VSCode加CMake tools插件）
  </a>
  
    <nav class="md-nav" aria-label="6. 交叉编译配置示例（基于VSCode加CMake tools插件）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-toolchain" class="md-nav__link">
    6.1 toolchain文件：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-kit" class="md-nav__link">
    6.2 添加编译kit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-cmakeliststxt" class="md-nav__link">
    6.3 CMakeLists.txt示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Cmake</h1>

<div class="toc">
<ul>
<li><a href="#cmake">一、Cmake 简介</a></li>
<li><a href="#_1">二、常用命令</a><ul>
<li><a href="#1-cmake">1. 指定 cmake 的最小版本</a></li>
<li><a href="#2">2. 设置项目名称</a></li>
<li><a href="#3">3. 设置编译类型</a></li>
<li><a href="#4">4. 指定编译包含的源文件</a><ul>
<li><a href="#41">4.1 明确指定包含哪些源文件</a></li>
<li><a href="#42-cpp">4.2 搜索所有的 cpp 文件</a></li>
<li><a href="#43">4.3 自定义搜索规则</a></li>
</ul>
</li>
<li><a href="#5">5. 查找指定的库文件</a></li>
<li><a href="#6">6. 设置包含的目录</a></li>
<li><a href="#7">7. 设置链接库搜索目录</a></li>
<li><a href="#8-target">8. 设置 target 需要链接的库</a><ul>
<li><a href="#81">8.1 指定链接动态库或静态库</a></li>
<li><a href="#82">8.2 指定全路径</a></li>
<li><a href="#83">8.3 指定链接多个库</a></li>
</ul>
</li>
<li><a href="#9">9. 设置变量</a><ul>
<li><a href="#91-set">9.1 set 直接设置变量的值</a></li>
<li><a href="#92-set">9.2 set 追加设置变量的值</a></li>
<li><a href="#93-list">9.3 list 追加或者删除变量的值</a></li>
<li><a href="#94">9.4 编译时设置宏定义</a></li>
</ul>
</li>
<li><a href="#10">10. 条件控制</a><ul>
<li><a href="#101-ifelseifelseendif">10.1 if…elseif…else…endif</a></li>
<li><a href="#102-whileendwhile">10.2 while…endwhile</a></li>
<li><a href="#103-foreachendforeach">10.3 foreach…endforeach</a></li>
</ul>
</li>
<li><a href="#11">11. 打印信息</a></li>
<li><a href="#12-cmake">12. 包含其它 cmake 文件</a></li>
</ul>
</li>
<li><a href="#_2">三、常用变量</a><ul>
<li><a href="#1">1. 预定义变量</a></li>
<li><a href="#2_1">2. 环境变量</a></li>
<li><a href="#3_1">3. 系统信息</a></li>
<li><a href="#4_1">4. 主要开关选项</a></li>
<li><a href="#5_1">5. 常用编译选项配置</a></li>
<li><a href="#6-vscodecmake-tools">6. 交叉编译配置示例（基于VSCode加CMake tools插件）</a><ul>
<li><a href="#61-toolchain">6.1 toolchain文件：</a></li>
<li><a href="#62-kit">6.2 添加编译kit</a></li>
<li><a href="#63-cmakeliststxt">6.3 CMakeLists.txt示例</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>原文链接：https://blog.csdn.net/afei__/article/details/81201039</p>
<h2 id="cmake">一、Cmake 简介</h2>
<p>cmake 是一个<strong>跨平台、开源的构建系统</strong>。它是一个<strong>集软件构建、测试、打包于一身的软件</strong>。它使用与平台和编译器独立的配置文件来对软件编译过程进行控制。</p>
<h2 id="_1">二、常用命令</h2>
<h3 id="1-cmake">1. 指定 cmake 的最小版本</h3>
<div class="highlight"><pre><span></span><code><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.4.1</span><span class="p">)</span>
</code></pre></div>
<p>这行命令是<strong>可选的</strong>，我们可以不写这句话，但在有些情况下，如果 CMakeLists.txt 文件中使用了一些高版本 cmake 特有的一些命令的时候，就需要加上这样一行，<strong>提醒用户升级到该版本之后再执行 cmake</strong>。</p>
<h3 id="2">2. 设置项目名称</h3>
<div class="highlight"><pre><span></span><code><span class="nb">project</span><span class="p">(</span><span class="s">demo</span><span class="p">)</span>
</code></pre></div>
<p>这个命令不是强制性的，但最好都加上。</p>
<p><strong>它会引入两个变量 demo_BINARY_DIR 和 demo_SOURCE_DIR</strong>，</p>
<p>同时，cmake 自动定义了两个等价的变量 PROJECT_BINARY_DIR 和 PROJECT_SOURCE_DIR。</p>
<h3 id="3">3. 设置编译类型</h3>
<div class="highlight"><pre><span></span><code><span class="nb">add_executable</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="s">demo.cpp</span><span class="p">)</span><span class="w"> </span><span class="c"># 生成可执行文件</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">common</span><span class="w"> </span><span class="s">STATIC</span><span class="w"> </span><span class="s">util.cpp</span><span class="p">)</span><span class="w"> </span><span class="c"># 生成静态库</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">common</span><span class="w"> </span><span class="s">SHARED</span><span class="w"> </span><span class="s">util.cpp</span><span class="p">)</span><span class="w"> </span><span class="c"># 生成动态库或共享库</span>
</code></pre></div>
<p>add_library <strong>默认生成是静态库</strong>，通过以上命令生成文件名字，</p>
<p><strong>在 Linux 下是：</strong></p>
<p>demo</p>
<p>libcommon.a</p>
<p>libcommon.so</p>
<p><strong>在 Windows 下是：</strong></p>
<p>demo.exe</p>
<p>common.lib</p>
<p>common.dll</p>
<h3 id="4">4. 指定编译包含的源文件</h3>
<h4 id="41">4.1 明确指定包含哪些源文件</h4>
<div class="highlight"><pre><span></span><code><span class="nb">add_library</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="s">demo.cpp</span><span class="w"> </span><span class="s">test.cpp</span><span class="w"> </span><span class="s">util.cpp</span><span class="p">)</span>
</code></pre></div>
<h4 id="42-cpp">4.2 搜索所有的 cpp 文件</h4>
<p>aux_source_directory(dir VAR) <strong>发现一个目录下所有的源代码文件</strong>并将列表存储在一个变量中。</p>
<div class="highlight"><pre><span></span><code><span class="nb">aux_source_directory</span><span class="p">(</span><span class="s">.</span><span class="w"> </span><span class="s">SRC_LIST</span><span class="p">)</span><span class="w"> </span><span class="c"># 搜索当前目录下的所有.cpp文件</span>

<span class="nb">add_library</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="p">)</span>
</code></pre></div>
<h4 id="43">4.3 自定义搜索规则</h4>
<div class="highlight"><pre><span></span><code><span class="nb">file</span><span class="p">(</span><span class="s">GLOB</span><span class="w"> </span><span class="s">SRC_LIST</span><span class="w"> </span><span class="s2">&quot;*.cpp&quot;</span><span class="w"> </span><span class="s2">&quot;protocol/*.cpp&quot;</span><span class="p">)</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="p">)</span>
<span class="c"># 或者</span>
<span class="nb">file</span><span class="p">(</span><span class="s">GLOB</span><span class="w"> </span><span class="s">SRC_LIST</span><span class="w"> </span><span class="s2">&quot;*.cpp&quot;</span><span class="p">)</span>
<span class="nb">file</span><span class="p">(</span><span class="s">GLOB</span><span class="w"> </span><span class="s">SRC_PROTOCOL_LIST</span><span class="w"> </span><span class="s2">&quot;protocol/*.cpp&quot;</span><span class="p">)</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_PROTOCOL_LIST</span><span class="o">}</span><span class="p">)</span>
<span class="c"># 或者</span>
<span class="nb">file</span><span class="p">(</span><span class="s">GLOB_RECURSE</span><span class="w"> </span><span class="s">SRC_LIST</span><span class="w"> </span><span class="s2">&quot;*.cpp&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">#递归搜索</span>
<span class="nb">FILE</span><span class="p">(</span><span class="s">GLOB</span><span class="w"> </span><span class="s">SRC_PROTOCOL</span><span class="w"> </span><span class="s">RELATIVE</span><span class="w"> </span><span class="s2">&quot;protocol&quot;</span><span class="w"> </span><span class="s2">&quot;*.cpp&quot;</span><span class="p">)</span><span class="w"> </span><span class="c"># 相对protocol目录下搜索</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_PROTOCOL_LIST</span><span class="o">}</span><span class="p">)</span>
<span class="c"># 或者</span>
<span class="nb">aux_source_directory</span><span class="p">(</span><span class="s">.</span><span class="w"> </span><span class="s">SRC_LIST</span><span class="p">)</span>
<span class="nb">aux_source_directory</span><span class="p">(</span><span class="s">protocol</span><span class="w"> </span><span class="s">SRC_PROTOCOL_LIST</span><span class="p">)</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_PROTOCOL_LIST</span><span class="o">}</span><span class="p">)</span>
</code></pre></div>
<h3 id="5">5. 查找指定的库文件</h3>
<p><strong>find_library(VAR name path)</strong> 查找到指定的预编译库，并将它的路径存储在变量中。</p>
<p><strong>默认的搜索路径为 cmake 包含的系统库</strong>，因此如果是 NDK 的公共库只需要指定库的 name 即可。</p>
<div class="highlight"><pre><span></span><code><span class="nb">find_library</span><span class="p">(</span><span class="w"> </span><span class="c"># Sets the name of the path variable.</span>
<span class="w">              </span><span class="s">log-lib</span>

<span class="w">              </span><span class="c"># Specifies the name of the NDK library that</span>
<span class="w">              </span><span class="c"># you want CMake to locate.</span>
<span class="w">              </span><span class="s">log</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>类似的命令还有 find_file()、find_path()、find_program()、find_package()。</p>
<h3 id="6">6. 设置包含的目录</h3>
<div class="highlight"><pre><span></span><code><span class="nb">include_directories</span><span class="p">(</span>
<span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span>
<span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span>
<span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/include</span>
<span class="p">)</span>
</code></pre></div>
<p>Linux 下还可以通过如下方式设置包含的目录</p>
<div class="highlight"><pre><span></span><code><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS</span><span class="w"> </span><span class="s2">&quot;${CMAKE_CXX_FLAGS} -I${CMAKE_CURRENT_SOURCE_DIR}&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="7">7. 设置链接库搜索目录</h3>
<div class="highlight"><pre><span></span><code><span class="nb">link_directories</span><span class="p">(</span>
<span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/libs</span>
<span class="p">)</span>
</code></pre></div>
<p>Linux 下还可以通过如下方式设置包含的目录</p>
<div class="highlight"><pre><span></span><code><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS</span><span class="w"> </span><span class="s2">&quot;${CMAKE_CXX_FLAGS} -L${CMAKE_CURRENT_SOURCE_DIR}/libs&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="8-target">8. 设置 target 需要链接的库</h3>
<div class="highlight"><pre><span></span><code><span class="nb">target_link_libraries</span><span class="p">(</span><span class="w"> </span><span class="c"># 目标库</span>
<span class="w">                       </span><span class="s">demo</span>
<span class="w">                       </span><span class="c"># 目标库需要链接的库</span>
<span class="w">                       </span><span class="c"># log-lib 是上面 find_library 指定的变量名</span>
<span class="w">                       </span><span class="o">${</span><span class="nv">log-lib</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>在 Windows 下，系统会根据链接库目录，搜索xxx.lib 文件，Linux 下会搜索 xxx.so 或者 xxx.a 文件，如果都存在会优先链接动态库（so 后缀）。</p>
<h4 id="81">8.1 指定链接动态库或静态库</h4>
<div class="highlight"><pre><span></span><code><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="s">libface.a</span><span class="p">)</span><span class="w"> </span><span class="c"># 链接libface.a</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="s">libface.so</span><span class="p">)</span><span class="w"> </span><span class="c"># 链接libface.so</span>
</code></pre></div>
<h4 id="82">8.2 指定全路径</h4>
<div class="highlight"><pre><span></span><code><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/libs/libface.a</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/libs/libface.so</span><span class="p">)</span>
</code></pre></div>
<h4 id="83">8.3 指定链接多个库</h4>
<div class="highlight"><pre><span></span><code><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">demo</span>
<span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/libs/libface.a</span>
<span class="w">    </span><span class="s">boost_system.a</span>
<span class="w">    </span><span class="s">boost_thread</span>
<span class="w">    </span><span class="s">pthread</span><span class="p">)</span>
</code></pre></div>
<h3 id="9">9. 设置变量</h3>
<h4 id="91-set">9.1 set 直接设置变量的值</h4>
<div class="highlight"><pre><span></span><code><span class="nb">set</span><span class="p">(</span><span class="s">SRC_LIST</span><span class="w"> </span><span class="s">main.cpp</span><span class="w"> </span><span class="s">test.cpp</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="p">)</span>
</code></pre></div>
<h4 id="92-set">9.2 set 追加设置变量的值</h4>
<div class="highlight"><pre><span></span><code><span class="nb">set</span><span class="p">(</span><span class="s">SRC_LIST</span><span class="w"> </span><span class="s">main.cpp</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">SRC_LIST</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="w"> </span><span class="s">test.cpp</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="p">)</span>
</code></pre></div>
<h4 id="93-list">9.3 list 追加或者删除变量的值</h4>
<div class="highlight"><pre><span></span><code><span class="nb">set</span><span class="p">(</span><span class="s">SRC_LIST</span><span class="w"> </span><span class="s">main.cpp</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="s">APPEND</span><span class="w"> </span><span class="s">SRC_LIST</span><span class="w"> </span><span class="s">test.cpp</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="s">REMOVE_ITEM</span><span class="w"> </span><span class="s">SRC_LIST</span><span class="w"> </span><span class="s">main.cpp</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="p">)</span>
</code></pre></div>
<h4 id="94">9.4 编译时设置宏定义</h4>
<p><strong>target_compile_definitions</strong>在编译target对应的依赖文件时自动加上<code>-DMY_DEFINITION</code></p>
<div class="highlight"><pre><span></span><code><span class="nb">target_compile_definitions</span><span class="p">(</span><span class="s">target</span><span class="w"> </span><span class="s">PRIVATE</span><span class="w"> </span><span class="s">MY_DEFINITION</span><span class="p">)</span>
</code></pre></div>
<h3 id="10">10. 条件控制</h3>
<h4 id="101-ifelseifelseendif">10.1 if…elseif…else…endif</h4>
<p><strong>逻辑判断和比较：</strong></p>
<p>if (expression) ：expression 不为空（0,N,NO,OFF,FALSE,NOTFOUND）时为真</p>
<p>if (not exp) ：与上面相反</p>
<p>if (var1 AND var2)</p>
<p>if (var1 OR var2)</p>
<p>if (COMMAND cmd) ：如果 cmd 确实是命令并可调用为真</p>
<p>if (EXISTS dir) if (EXISTS file) ：如果目录或文件存在为真</p>
<p>if (file1 IS_NEWER_THAN file2) ：当 file1 比 file2 新，或 file1/file2 中有一个不存在时为真，文件名需使用全路径</p>
<p>if (IS_DIRECTORY dir) ：当 dir 是目录时为真</p>
<p>if (DEFINED var) ：如果变量被定义为真</p>
<p>if (var MATCHES regex) ：给定的变量或者字符串能够匹配正则表达式 regex 时为真，此处 var 可以用 var 名，也可以用 ${var}</p>
<p>if (string MATCHES regex)</p>
<p><strong>数字比较：</strong></p>
<p>if (variable LESS number)：LESS 小于</p>
<p>if (string LESS number)</p>
<p>if (variable GREATER number)：GREATER 大于</p>
<p>if (string GREATER number)</p>
<p>if (variable EQUAL number)：EQUAL 等于</p>
<p>if (string EQUAL number)</p>
<p><strong>字母表顺序比较：</strong></p>
<p>if (variable STRLESS string)</p>
<p>if (string STRLESS string)</p>
<p>if (variable STRGREATER string)</p>
<p>if (string STRGREATER string)</p>
<p>if (variable STREQUAL string)</p>
<p>if (string STREQUAL string)</p>
<p>示例：</p>
<div class="highlight"><pre><span></span><code><span class="nb">if</span><span class="p">(</span><span class="s">MSVC</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="s">LINK_LIBS</span><span class="w"> </span><span class="s">common</span><span class="p">)</span>
<span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="s">boost_thread</span><span class="w"> </span><span class="s">boost_log.a</span><span class="w"> </span><span class="s">boost_system.a</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">demo</span><span class="w"> </span><span class="o">${</span><span class="nv">LINK_LIBS</span><span class="o">}</span><span class="p">)</span>
<span class="c"># 或者</span>
<span class="nb">if</span><span class="p">(</span><span class="s">UNIX</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS</span><span class="w"> </span><span class="s2">&quot;${CMAKE_CXX_FLAGS} -std=c++11 -fpermissive -g&quot;</span><span class="p">)</span>
<span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="nb">add_definitions</span><span class="p">(</span><span class="s">-D_SCL_SECURE_NO_WARNINGS</span>
<span class="w">    </span><span class="s">D_CRT_SECURE_NO_WARNINGS</span>
<span class="w">    </span><span class="s">-D_WIN32_WINNT=0x601</span>
<span class="w">    </span><span class="s">-D_WINSOCK_DEPRECATED_NO_WARNINGS</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">if</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_BUILD_TYPE</span><span class="o">}</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s2">&quot;debug&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="err">...</span>
<span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="err">...</span>
<span class="nb">endif</span><span class="p">()</span>
</code></pre></div>
<h4 id="102-whileendwhile">10.2 while…endwhile</h4>
<div class="highlight"><pre><span></span><code><span class="nb">while</span><span class="p">(</span><span class="s">condition</span><span class="p">)</span>
<span class="w">    </span><span class="err">...</span>
<span class="nb">endwhile</span><span class="p">()</span>
</code></pre></div>
<h4 id="103-foreachendforeach">10.3 foreach…endforeach</h4>
<div class="highlight"><pre><span></span><code><span class="nb">foreach</span><span class="p">(</span><span class="s">loop_var</span><span class="w"> </span><span class="s">RANGE</span><span class="w"> </span><span class="s">start</span><span class="w"> </span><span class="s">stop</span><span class="w"> </span><span class="s">[step]</span><span class="p">)</span>
<span class="w">    </span><span class="err">...</span>
<span class="nb">endforeach</span><span class="p">(</span><span class="s">loop_var</span><span class="p">)</span>
</code></pre></div>
<p>start 表示起始数，stop 表示终止数，step 表示步长，示例：</p>
<div class="highlight"><pre><span></span><code><span class="nb">foreach</span><span class="p">(</span><span class="s">i</span><span class="w"> </span><span class="s">RANGE</span><span class="w"> </span><span class="s">1</span><span class="w"> </span><span class="s">9</span><span class="w"> </span><span class="s">2</span><span class="p">)</span>
<span class="w">    </span><span class="nb">message</span><span class="p">(</span><span class="o">${</span><span class="nv">i</span><span class="o">}</span><span class="p">)</span>
<span class="nb">endforeach</span><span class="p">(</span><span class="s">i</span><span class="p">)</span>
<span class="c"># 输出：13579</span>
</code></pre></div>
<h3 id="11">11. 打印信息</h3>
<div class="highlight"><pre><span></span><code><span class="nb">message</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="p">)</span>
<span class="nb">message</span><span class="p">(</span><span class="s2">&quot;build with debug mode&quot;</span><span class="p">)</span>
<span class="nb">message</span><span class="p">(</span><span class="s">WARNING</span><span class="w"> </span><span class="s2">&quot;this is warnning message&quot;</span><span class="p">)</span>
<span class="nb">message</span><span class="p">(</span><span class="s">FATAL_ERROR</span><span class="w"> </span><span class="s2">&quot;this build has many error&quot;</span><span class="p">)</span><span class="w"> </span><span class="c"># FATAL_ERROR 会导致编译失败</span>
</code></pre></div>
<h3 id="12-cmake">12. 包含其它 cmake 文件</h3>
<div class="highlight"><pre><span></span><code><span class="nb">include</span><span class="p">(</span><span class="s">./common.cmake</span><span class="p">)</span><span class="w"> </span><span class="c"># 指定包含文件的全路径</span>
<span class="nb">include</span><span class="p">(</span><span class="s">def</span><span class="p">)</span><span class="w"> </span><span class="c"># 在搜索路径中搜索def.cmake文件</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_MODULE_PATH</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/cmake</span><span class="p">)</span><span class="w"> </span><span class="c"># 设置include的搜索路径</span>
</code></pre></div>
<h2 id="_2">三、常用变量</h2>
<h3 id="1">1. 预定义变量</h3>
<p><strong>PROJECT_SOURCE_DIR</strong>：工程的根目录</p>
<p><strong>PROJECT_BINARY_DIR</strong>：运行 cmake 命令的目录，通常是 ${PROJECT_SOURCE_DIR}/build</p>
<p><strong>PROJECT_NAME</strong>：返回通过 project 命令定义的项目名称</p>
<p><strong>CMAKE_CURRENT_SOURCE_DIR</strong>：当前处理的 CMakeLists.txt 所在的路径</p>
<p><strong>CMAKE_CURRENT_BINARY_DIR</strong>：target 编译目录</p>
<p><strong>CMAKE_CURRENT_LIST_DIR</strong>：CMakeLists.txt 的完整路径</p>
<p><strong>CMAKE_CURRENT_LIST_LINE</strong>：当前所在的行</p>
<p><strong>CMAKE_MODULE_PATH</strong>：
定义自己的 cmake 模块所在的路径，
<div class="highlight"><pre><span></span><code><span class="nb">SET</span><span class="p">(</span><span class="s">CMAKE_MODULE_PATH</span><span class="w"> </span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/cmake</span><span class="p">)</span>
</code></pre></div>
，然后可以用INCLUDE命令来调用自己的模块</p>
<p><strong>EXECUTABLE_OUTPUT_PATH</strong>：重新定义目标二进制可执行文件的存放位置</p>
<p><strong>LIBRARY_OUTPUT_PATH</strong>：重新定义目标链接库文件的存放位置</p>
<h3 id="2_1">2. 环境变量</h3>
<p>使用环境变量
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="err">$ENV{Name}</span>
</code></pre></div></p>
<p>写入环境变量
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="s">ENV{Name}</span><span class="w"> </span><span class="s">value</span><span class="p">)</span><span class="w"> </span><span class="c"># 这里没有“$”符号</span>
</code></pre></div></p>
<h3 id="3_1">3. 系统信息</h3>
<p>­CMAKE_MAJOR_VERSION：cmake 主版本号，比如 3.4.1 中的 3</p>
<p>­CMAKE_MINOR_VERSION：cmake 次版本号，比如 3.4.1 中的 4</p>
<p>­CMAKE_PATCH_VERSION：cmake 补丁等级，比如 3.4.1 中的 1</p>
<p>­CMAKE_SYSTEM：系统名称，比如 Linux-­2.6.22</p>
<p>­CMAKE_SYSTEM_NAME：不包含版本的系统名，比如 Linux</p>
<p>­CMAKE_SYSTEM_VERSION：系统版本，比如 2.6.22</p>
<p>­CMAKE_SYSTEM_PROCESSOR：处理器名称，比如 i686</p>
<p>­UNIX：在所有的类 UNIX 平台下该值为 TRUE，包括 OS X 和 cygwin</p>
<p>­WIN32：在所有的 win32 平台下该值为 TRUE，包括 cygwin</p>
<h3 id="4_1">4. 主要开关选项</h3>
<p><strong>BUILD_SHARED_LIBS</strong>：这个开关用来控制默认的库编译方式，如果不进行设置，使用 add_library 又没有指定库类型的情况下，默认编译生成的库都是静态库。<strong>如果 set(BUILD_SHARED_LIBS ON) 后，默认生成的为动态库</strong></p>
<h3 id="5_1">5. 常用编译选项配置</h3>
<p><strong>CMAKE_C_FLAGS</strong>：设置 C 编译选项，也可以通过指令 add_definitions() 添加，对它的修改会对所有build variant生效</p>
<p><strong>CMAKE_CXX_FLAGS</strong>：同CMAKE_C_FLAGS，但影响 C++ 编译选项</p>
<div class="highlight"><pre><span></span><code><span class="nb">add_definitions</span><span class="p">(</span><span class="s">-DENABLE_DEBUG</span><span class="w"> </span><span class="s">-DABC</span><span class="p">)</span><span class="w"> </span><span class="c"># 参数之间用空格分隔</span>
</code></pre></div>
<h3 id="6-vscodecmake-tools">6. 交叉编译配置示例（基于VSCode加CMake tools插件）</h3>
<h4 id="61-toolchain">6.1 toolchain文件：</h4>
<p>下面的文件用于windows下嵌入式MIPS处理器的交叉编译
<div class="highlight"><pre><span></span><code><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SYSTEM_NAME</span><span class="w"> </span><span class="s">Generic</span><span class="p">)</span><span class="w"> </span><span class="c"># 嵌入式用generic，其它系统还包括Linux，win32等</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SYSTEM_PROCESSOR</span><span class="w"> </span><span class="s">MIPS</span><span class="p">)</span>

<span class="nb">set</span><span class="p">(</span><span class="s">TOOLCHAIN_PREFIX</span><span class="w"> </span><span class="s">nanomips-elf-</span><span class="p">)</span>

<span class="nb">set</span><span class="p">(</span><span class="s">BINUTILS_PATH</span><span class="w"> </span><span class="s2">&quot;D:\\crosscompile\\nanomips-elf\\2019.03-06\\bin\\nanomips-elf-gcc&quot;</span><span class="p">)</span>

<span class="nb">get_filename_component</span><span class="p">(</span><span class="s">MIPS_TOOLCHAIN_DIR</span><span class="w"> </span><span class="o">${</span><span class="nv">BINUTILS_PATH</span><span class="o">}</span><span class="w"> </span><span class="s">DIRECTORY</span><span class="p">)</span>
<span class="c"># Without that flag CMake is not able to pass test compilation check</span>
<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_VERSION</span><span class="o">}</span><span class="w"> </span><span class="s">VERSION_EQUAL</span><span class="w"> </span><span class="s2">&quot;3.6.0&quot;</span><span class="w"> </span><span class="s">OR</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_VERSION</span><span class="o">}</span><span class="w"> </span><span class="s">VERSION_GREATER</span><span class="w"> </span><span class="s2">&quot;3.6&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_TRY_COMPILE_TARGET_TYPE</span><span class="w"> </span><span class="s">STATIC_LIBRARY</span><span class="p">)</span>
<span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_EXE_LINKER_FLAGS_INIT</span><span class="w"> </span><span class="s2">&quot;--specs=nosys.specs&quot;</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_COMPILER</span><span class="w"> </span><span class="o">${</span><span class="nv">MIPS_TOOLCHAIN_DIR</span><span class="o">}</span><span class="s">/</span><span class="o">${</span><span class="nv">TOOLCHAIN_PREFIX</span><span class="o">}</span><span class="s">gcc.exe</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_ASM_COMPILER</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_C_COMPILER</span><span class="o">}</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_COMPILER</span><span class="w"> </span><span class="o">${</span><span class="nv">MIPS_TOOLCHAIN_DIR</span><span class="o">}</span><span class="s">/</span><span class="o">${</span><span class="nv">TOOLCHAIN_PREFIX</span><span class="o">}</span><span class="s">g++.exe</span><span class="p">)</span>

<span class="c"># Default C compiler flags 后面所有variant编译时都会自动加上这些</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_FLAGS</span><span class="w"> </span><span class="s2">&quot; -EL -march=i7200 -mclib=tiny -G128 -fgcse-sm -fgcse-las -T uhi32.ld -fdata-sections -ffunction-sections -Wl,-gc-sections -Wl,--defsym,__getargs=0 -Wl,--defsym,__exception_handle_verbose=0&quot;</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">STRING</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="s">FORCE</span><span class="p">)</span>

<span class="c"># CMAKE_C_FLAGS_DEBUG_INIT的内容会被自动包含到CMAKE_C_FLAGS_DEBUG里，下同</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_FLAGS_DEBUG_INIT</span><span class="w"> </span><span class="s2">&quot;-g3 -Og -Wall -pedantic -DDEBUG&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_FLAGS_RELEASE_INIT</span><span class="w"> </span><span class="s2">&quot;-O3 -Wall&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_FLAGS_MINSIZEREL_INIT</span><span class="w"> </span><span class="s2">&quot;-Os -Wall&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_FLAGS_RELWITHDEBINFO_INIT</span><span class="w">  </span><span class="s2">&quot;-O2 -g -Wall&quot;</span><span class="p">)</span>
<span class="c"># Default C++ compiler flags</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS_DEBUG_INIT</span><span class="w"> </span><span class="s2">&quot;-g3 -Og -Wall -pedantic -DDEBUG&quot;</span><span class="p">)</span>
<span class="c"># set(CMAKE_CXX_FLAGS_DEBUG &quot;${CMAKE_CXX_FLAGS_DEBUG_INIT}&quot; CACHE STRING &quot;&quot; FORCE)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS_RELEASE_INIT</span><span class="w"> </span><span class="s2">&quot;-O3 -Wall&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS_MINSIZEREL_INIT</span><span class="w"> </span><span class="s2">&quot;-Os -Wall&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS_RELWITHDEBINFO_INIT</span><span class="w">  </span><span class="s2">&quot;-O2 -g -Wall&quot;</span><span class="p">)</span>

<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_OBJCOPY</span><span class="w"> </span><span class="o">${</span><span class="nv">MIPS_TOOLCHAIN_DIR</span><span class="o">}</span><span class="s">/</span><span class="o">${</span><span class="nv">TOOLCHAIN_PREFIX</span><span class="o">}</span><span class="s">objcopy.exe</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;objcopy tool&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SIZE_UTIL</span><span class="w"> </span><span class="o">${</span><span class="nv">MIPS_TOOLCHAIN_DIR</span><span class="o">}</span><span class="s">/</span><span class="o">${</span><span class="nv">TOOLCHAIN_PREFIX</span><span class="o">}</span><span class="s">size.exe</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;size tool&quot;</span><span class="p">)</span>

<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SYSROOT</span><span class="w"> </span><span class="o">${</span><span class="nv">MIPS_TOOLCHAIN_DIR</span><span class="o">}</span><span class="s">/../nanomips-elf</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_FIND_ROOT_PATH</span><span class="w"> </span><span class="o">${</span><span class="nv">MIPS_TOOLCHAIN_DIR</span><span class="o">}</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_FIND_ROOT_PATH_MODE_PROGRAM</span><span class="w"> </span><span class="s">NEVER</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_FIND_ROOT_PATH_MODE_LIBRARY</span><span class="w"> </span><span class="s">ONLY</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_FIND_ROOT_PATH_MODE_INCLUDE</span><span class="w"> </span><span class="s">ONLY</span><span class="p">)</span>
</code></pre></div></p>
<h4 id="62-kit">6.2 添加编译kit</h4>
<div class="highlight"><pre><span></span><code><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;GCC 8.1.0 x86_64-w64-mingw32&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;compilers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;C&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D:\\tools\\MinGW\\bin\\x86_64-w64-mingw32-gcc.exe&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;CXX&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D:\\tools\\MinGW\\bin\\x86_64-w64-mingw32-g++.exe&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;preferredGenerator&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MinGW Makefiles&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;environmentVariables&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;CMT_MINGW_PATH&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D:\\tools\\MinGW\\bin&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ARM-none-EABI&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;toolchainFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D:\\crosscompile\\gcc-arm-none-eabi-10.3-2021.07\\armtoolchain.cmake&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="err">前文的</span><span class="kc">t</span><span class="err">oolchai</span><span class="kc">n</span><span class="err">文件路径，</span><span class="kc">na</span><span class="err">me可以随便起</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;nanoMIPS&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;toolchainFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D:\\crosscompile\\nanomips-elf\\mipstoolchain.cmake&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>
<h4 id="63-cmakeliststxt">6.3 CMakeLists.txt示例</h4>
<p>下面的CMakeLists.txt支持Windows/ARM/MIPS的编译，并在MIPS下修改编译选项，增加额外的文件和宏定义：
<div class="highlight"><pre><span></span><code><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.0.0</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">nrtest</span><span class="w"> </span><span class="s">VERSION</span><span class="w"> </span><span class="s">0.1.0</span><span class="p">)</span>

<span class="nb">include</span><span class="p">(</span><span class="s">CTest</span><span class="p">)</span>
<span class="nb">enable_testing</span><span class="p">()</span>

<span class="nb">set</span><span class="p">(</span><span class="s">DIR_LIST</span><span class="w"> </span><span class="s">AFC</span><span class="w"> </span><span class="s">AGC</span><span class="w"> </span><span class="s">ATC</span><span class="w"> </span><span class="s">COMMON</span><span class="w"> </span><span class="s">MEAS</span><span class="w"> </span><span class="s">PAL</span><span class="w"> </span><span class="s">RRC</span><span class="w"> </span><span class="s">SYNC</span><span class="w"> </span><span class="s">TEST</span><span class="p">)</span>

<span class="nb">set</span><span class="p">(</span><span class="s">ALL_SRCS</span><span class="p">)</span>

<span class="nb">foreach</span><span class="p">(</span><span class="s">_module</span><span class="w"> </span><span class="o">${</span><span class="nv">DIR_LIST</span><span class="o">}</span><span class="p">)</span>
<span class="w">    </span><span class="nb">include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/</span><span class="o">${</span><span class="nv">_module</span><span class="o">}</span><span class="s">/INC</span><span class="p">)</span>
<span class="w">    </span><span class="nb">aux_source_directory</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/</span><span class="o">${</span><span class="nv">_module</span><span class="o">}</span><span class="s">/SRC</span><span class="w"> </span><span class="o">${</span><span class="nv">_module</span><span class="o">}</span><span class="s">_SRC</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="s">ALL_SRCS</span><span class="w"> </span><span class="o">${</span><span class="nv">ALL_SRCS</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">${_module</span><span class="o">}</span><span class="s">_SRC}</span><span class="p">)</span>
<span class="w">    </span><span class="nb">message</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;files in ${_module}: ${${_module}_SRC}&quot;</span><span class="p">)</span>
<span class="nb">endforeach</span><span class="p">(</span><span class="s">_module</span><span class="p">)</span>

<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_SYSTEM_PROCESSOR</span><span class="o">}</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s">MIPS</span><span class="p">)</span>
<span class="w">    </span><span class="nb">include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/MIPS</span><span class="p">)</span>
<span class="w">    </span><span class="nb">aux_source_directory</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/MIPS</span><span class="w"> </span><span class="s">MIPS_SRC</span><span class="p">)</span>
<span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="s">ALL_SRCS</span><span class="w"> </span><span class="o">${</span><span class="nv">ALL_SRCS</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">MIPS_SRC</span><span class="o">}</span><span class="p">)</span>
<span class="w">    </span><span class="nb">message</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;MIPS specific: ${MIPS_SRC}&quot;</span><span class="p">)</span>
<span class="nb">else</span><span class="p">()</span>
<span class="w">    </span><span class="nb">message</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;system：${CMAKE_SYSTEM_PROCESSOR}&quot;</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">add_executable</span><span class="p">(</span><span class="s">nrtest</span><span class="w">  </span><span class="o">${</span><span class="nv">ALL_SRCS</span><span class="o">}</span><span class="p">)</span>

<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_SYSTEM_PROCESSOR</span><span class="o">}</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s">MIPS</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_compile_definitions</span><span class="p">(</span><span class="s">nrtest</span><span class="w"> </span><span class="s">PRIVATE</span><span class="w"> </span><span class="s">MIPS_DEBUG</span><span class="p">)</span>
<span class="w">    </span><span class="nb">message</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;MIPS_DEBUG enabled!&quot;</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>


<span class="nb">set</span><span class="p">(</span><span class="s">CPACK_PROJECT_NAME</span><span class="w"> </span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CPACK_PROJECT_VERSION</span><span class="w"> </span><span class="o">${</span><span class="nv">PROJECT_VERSION</span><span class="o">}</span><span class="p">)</span>
<span class="nb">include</span><span class="p">(</span><span class="s">CPack</span><span class="p">)</span>
</code></pre></div></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/2.6.8/wavedrom.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/2.6.8/skins/default.js"></script>
      
        <script src="../../javascripts/wavedrom_loader.js"></script>
      
    
  </body>
</html>